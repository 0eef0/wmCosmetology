<button id="upload_widget" class="cloudinary-button">Upload files</button>

<script src="https://upload-widget.cloudinary.com/global/all.js"></script>

<script>
	window.onload = async function () {
		const data = await (await fetch('/api/signuploadwidget', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/json'
			},
			body: JSON.stringify({ folder: 'asdf' })
			//body folder takes current individual
		})).json();

		const options = {
			cloudName: data.cloudname,
			apiKey: data.apikey,
			uploadSignatureTimestamp: data.timestamp,
			uploadSignature: data.signature,
			cropping: true,
			folder: 'signed_upload_demo_u'
		}

		const myWidget = window.cloudinary.createUploadWidget(
			options
		)
		document.getElementById('upload_widget').addEventListener('click', () => myWidget.open(), false);
	}
</script>